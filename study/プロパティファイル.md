# 設定ファイル

Spring Bootではアプリケーションの設定を`application.properties`や`application.yml`ファイルで行います。  
※ 研修では可読性もよく現場でもよく使われるyaml形式の設定ファイルを使用します。
SpringBoot以外にCI/CDの設定など多く使われています。

```properties
spring.application.name=sample-app
```

```yaml
spring:
  application:
    name: sample-app
  datasource:
    url: jdbc:mysql://localhost:3306/sampledb
    username: root
    password: password
my-country:
  - name: Japan
    code: JP
    alias: JP
  - name: United States
    code: US
    alias: US
country: [Japan, United States, Canada]
app:
  # SpringBootでは環境変数や実行時引数を参照することができる
  url: ${APP_URL:http://localhost:8080}
```

### 設定ファイルの読み込み
Spring Bootでは、`@Value`アノテーションを使用して設定ファイルの値を読み込むことができます。
```yaml
app:
  name: Sample Application
  messages: [Hello, World]
```

```java
// finalは使用できない
@Value("${app.name}")
private String appName;

@Value("${app.messages}")
private List<String> messages;
```

または```@ConfigurationProperties`を使用して、設定ファイルの値をJavaオブジェクトにマッピングすることもできます。
```yaml
app:
  name: Sample Application
  messages: [Hello, World]
```

```java
@AllArgsConstructor
@ConfigurationProperties(prefix = "app")
public class AppConfig {
    private final String name;
    private final List<String> messages;
}
```

### サーバー環境ごとの設定
システム開発では、ローカル、開発環境(テスト環境)、ステージング環境、本番環境など、複数の環境が用意されています

Spring Bootでは、プロファイルを使用して環境ごとに異なる設定を管理することができます。
`application-{profile}.yml`という形式で設定ファイルを作成し、実行時に
`--spring.profiles.active={profile}`オプションを指定することで、特定のプロファイルの設定を読み込むことができます。

```
# application-dev.ymlが読み込まれる　(application.ymlが読み込まれた後にapplication-devの設定で上書きされる)
./gradlew bootRun --args='--spring.profiles.active=dev'

# application-prod.ymlとapplication-prod-tokyo.ymlが順に読み込まれる 
./gradlew bootRun --args='--spring.profiles.active=prod,prod-tokyo'
```
